{% extends 'base.html' %}
{% load static %}

{% block title %}–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è{% endblock %}

{% block content %}
<div class="row mt-4">
    <!-- –õ–ï–í–ê–Ø –ß–ê–°–¢–¨: –í—ã–±–æ—Ä –≥—Ä—É–ø–ø—ã -->
    <div class="col-lg-2">
        <div class="card mb-3">
            <div class="card-header bg-primary text-white">
                <i class="bi bi-people"></i> –ì—Ä—É–ø–ø–∞
            </div>
            <div class="card-body p-2">
                <select class="form-select form-select-sm" id="groupFilter">
                    <option value="">–í—ã–±—Ä–∞—Ç—å...</option>
                    {% for group in groups %}
                        <option value="{{ group.id }}" {% if selected_group and selected_group.id == group.id %}selected{% endif %}>
                            {{ group.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <!-- –ü—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è -->
        {% if selected_group %}
        <div class="card">
            <div class="card-header bg-success text-white">
                <i class="bi bi-book"></i> –ü—Ä–µ–¥–º–µ—Ç—ã
            </div>
            <div class="card-body p-0" style="max-height: 600px; overflow-y: auto;">
                <div class="list-group list-group-flush" id="subjectsList">
                    {% for subject in subjects %}
                        <div class="list-group-item subject-item p-2"
                             draggable="true"
                             data-subject-id="{{ subject.id }}"
                             data-subject-name="{{ subject.name }}"
                             data-teacher-id="{{ subject.teacher.id|default:'' }}"
                             data-teacher-name="{{ subject.teacher.user.get_full_name|default:'–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω' }}"
                             style="cursor: move; font-size: 0.85rem;">
                            <strong>{{ subject.name }}</strong><br>
                            <small class="text-muted">{{ subject.teacher.user.get_full_name|default:'–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω' }}</small>
                        </div>
                    {% empty %}
                        <div class="list-group-item text-muted small">–ù–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ß–ê–°–¢–¨: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
    <div class="col-lg-10">
        {% if not selected_group %}
            <div class="alert alert-info">
                <i class="bi bi-info-circle"></i> –í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É —Å–ª–µ–≤–∞
            </div>
        {% else %}
            <div class="card">
                <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                    <span><i class="bi bi-calendar-week"></i> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: {{ selected_group.name }}</span>
                    <div>
                        <a href="{% url 'schedule:manage_academic_week' %}" class="btn btn-light btn-sm">
                            <i class="bi bi-calendar-range"></i> –ù–µ–¥–µ–ª–∏
                        </a>
                        <a href="{% url 'schedule:export' %}?group={{ selected_group.id }}" class="btn btn-success btn-sm">
                            <i class="bi bi-download"></i> –≠–∫—Å–ø–æ—Ä—Ç
                        </a>
                    </div>
                </div>
                <div class="card-body p-0">
                    <!-- –í–ï–†–¢–ò–ö–ê–õ–¨–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê -->
                    <div class="table-responsive">
                        <table class="table table-bordered mb-0 schedule-table-vertical">
                            <thead class="table-light">
                                <tr>
                                    <th style="width: 80px;">–í—Ä–µ–º—è</th>
                                    <th>–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</th>
                                    <th>–í—Ç–æ—Ä–Ω–∏–∫</th>
                                    <th>–°—Ä–µ–¥–∞</th>
                                    <th>–ß–µ—Ç–≤–µ—Ä–≥</th>
                                    <th>–ü—è—Ç–Ω–∏—Ü–∞</th>
                                    <th>–°—É–±–±–æ—Ç–∞</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for time_slot in time_slots %}
                                    <tr>
                                        <td class="text-center align-middle time-cell">
                                            <strong>{{ time_slot.start_time|time:"H:i" }}</strong><br>
                                            <small class="text-muted">{{ time_slot.end_time|time:"H:i" }}</small>
                                        </td>

                                        {% for day in "012345" %}
                                            <td class="schedule-drop-zone p-2"
                                                data-group-id="{{ selected_group.id }}"
                                                data-day="{{ day }}"
                                                data-time-slot="{{ time_slot.id }}"
                                                style="min-height: 80px; vertical-align: top;">
                                                {% for slot in schedule_slots %}
                                                    {% if slot.day_of_week|stringformat:"s" == day and slot.time_slot.id == time_slot.id %}
                                                        <div class="lesson-card" data-slot-id="{{ slot.id }}">
                                                            <div class="d-flex align-items-start">
                                                                <!-- –ö–∞–±–∏–Ω–µ—Ç –°–õ–ï–í–ê -->
                                                                <div class="room-left me-2">
                                                                    <div class="room-display" style="cursor: pointer;">
                                                                        <span class="badge bg-secondary room-badge">
                                                                            {{ slot.room|default:'?' }}
                                                                        </span>
                                                                    </div>
                                                                    <div class="room-edit" style="display: none;">
                                                                        <input type="text" 
                                                                               class="form-control form-control-sm room-input" 
                                                                               value="{{ slot.room|default:'' }}" 
                                                                               placeholder="–ö–∞–±" 
                                                                               maxlength="10"
                                                                               style="width: 50px;">
                                                                    </div>
                                                                </div>

                                                                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–µ–¥–º–µ—Ç–µ -->
                                                                <div class="flex-grow-1 lesson-info">
                                                                    <strong class="subject-name">{{ slot.subject.name }}</strong><br>
                                                                    <small class="text-muted">{{ slot.teacher.user.get_full_name|default:'–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω' }}</small>
                                                                </div>

                                                                <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
                                                                <button type="button" 
                                                                        class="btn btn-sm btn-danger delete-slot ms-2"
                                                                        data-slot-id="{{ slot.id }}">
                                                                    <i class="bi bi-trash"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    {% endif %}
                                                {% endfor %}
                                            </td>
                                        {% endfor %}
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
            <div class="alert alert-info mt-3">
                <h6><i class="bi bi-info-circle"></i> –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h6>
                <ol class="mb-0">
                    <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –≤ –Ω—É–∂–Ω—É—é —è—á–µ–π–∫—É —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</li>
                    <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ <span class="badge bg-secondary">?</span> —Å–ª–µ–≤–∞ –æ—Ç –ø—Ä–µ–¥–º–µ—Ç–∞, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –∫–∞–±–∏–Ω–µ—Ç</li>
                    <li>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å, –∫–∞–±–∏–Ω–µ—Ç)</li>
                    <li>–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ <i class="bi bi-trash text-danger"></i></li>
                </ol>
            </div>
        {% endif %}
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ -->
<div class="modal fade" id="conflictModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title"><i class="bi bi-exclamation-triangle"></i> –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="conflictMessage"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –°—Ç–∏–ª–∏ -->
<style>
/* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ */
.schedule-table-vertical {
    font-size: 0.9rem;
}

.time-cell {
    background-color: #f8f9fa;
    font-weight: bold;
}

.schedule-drop-zone {
    background-color: #fff;
    border: 2px dashed #dee2e6;
    transition: all 0.2s;
    position: relative;
}

.schedule-drop-zone:hover {
    background-color: #f8f9fa;
}

.schedule-drop-zone.drag-over {
    background-color: #d1e7dd;
    border-color: #198754;
    border-style: solid;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–Ω—è—Ç–∏—è */
.lesson-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 8px;
    border-radius: 6px;
    margin-bottom: 4px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.lesson-card .subject-name {
    font-size: 0.9rem;
    display: block;
}

.lesson-card small {
    font-size: 0.75rem;
}

/* –ö–∞–±–∏–Ω–µ—Ç —Å–ª–µ–≤–∞ */
.room-left {
    min-width: 45px;
}

.room-badge {
    font-size: 0.8rem;
    padding: 4px 6px;
    cursor: pointer;
}

.room-badge:hover {
    background-color: #5c636a !important;
}

.room-input {
    font-size: 0.75rem;
    padding: 2px 4px;
    height: 28px;
}

/* –ü—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è */
.subject-item {
    cursor: move;
    transition: all 0.2s;
    user-select: none;
}

.subject-item:hover {
    background-color: #f0f0f0;
    transform: translateX(3px);
}

.subject-item:active {
    opacity: 0.5;
}

/* –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è */
.delete-slot {
    opacity: 0.8;
    padding: 2px 6px;
    font-size: 0.8rem;
}

.delete-slot:hover {
    opacity: 1;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes pulse-success {
    0%, 100% { background-color: #d1e7dd; }
    50% { background-color: #a3cfbb; }
}

.success-flash {
    animation: pulse-success 0.5s;
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω');

    // CSRF —Ç–æ–∫–µ–Ω
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');

    let draggedElement = null;
    let draggedData = {};

    // ============ DRAG AND DROP ============
    const subjectItems = document.querySelectorAll('.subject-item');
    subjectItems.forEach(item => {
        item.addEventListener('dragstart', function(e) {
            draggedElement = this;
            draggedData = {
                subjectId: this.dataset.subjectId,
                subjectName: this.dataset.subjectName,
                teacherId: this.dataset.teacherId,
                teacherName: this.dataset.teacherName
            };
            e.dataTransfer.effectAllowed = 'copy';
            this.style.opacity = '0.4';
        });

        item.addEventListener('dragend', function() {
            this.style.opacity = '1';
        });
    });

    // Drop –∑–æ–Ω—ã
    const dropZones = document.querySelectorAll('.schedule-drop-zone');
    dropZones.forEach(cell => {
        cell.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('drag-over');
        });

        cell.addEventListener('dragleave', function() {
            this.classList.remove('drag-over');
        });

        cell.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('drag-over');

            const groupId = this.dataset.groupId;
            const dayOfWeek = this.dataset.day;
            const timeSlot = this.dataset.timeSlot;

            if (!draggedData.subjectId) {
                showNotification('–û—à–∏–±–∫–∞: –Ω–µ –≤—ã–±—Ä–∞–Ω –ø—Ä–µ–¥–º–µ—Ç', 'danger');
                return;
            }

            createScheduleSlot(groupId, draggedData.subjectId, dayOfWeek, timeSlot, this);
        });
    });

    // ============ –°–û–ó–î–ê–ù–ò–ï –ó–ê–ù–Ø–¢–ò–Ø –° –ü–†–û–í–ï–†–ö–û–ô –ö–û–ù–§–õ–ò–ö–¢–û–í ============
    function createScheduleSlot(groupId, subjectId, dayOfWeek, timeSlot, cellElement) {
        const originalContent = cellElement.innerHTML;
        cellElement.innerHTML = '<div class="spinner-border spinner-border-sm text-primary"></div>';

        fetch('/schedule/constructor/create/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrftoken
            },
            body: JSON.stringify({
                group: groupId,
                subject: subjectId,
                day_of_week: dayOfWeek,
                time_slot: timeSlot
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const slotCard = createSlotCard(data.slot);
                cellElement.innerHTML = '';
                cellElement.appendChild(slotCard);
                cellElement.classList.add('success-flash');
                showNotification('‚úÖ –ó–∞–Ω—è—Ç–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞–±–∏–Ω–µ—Ç —Å–ª–µ–≤–∞, —á—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä.', 'success');
            } else {
                cellElement.innerHTML = originalContent;
                showConflictModal(data.error, data.conflicts || []);
            }
        })
        .catch(error => {
            cellElement.innerHTML = originalContent;
            showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'danger');
        });
    }

    // ============ –°–û–ó–î–ê–ù–ò–ï –ö–ê–†–¢–û–ß–ö–ò –ó–ê–ù–Ø–¢–ò–Ø ============
    function createSlotCard(slot) {
        const card = document.createElement('div');
        card.className = 'lesson-card';
        card.dataset.slotId = slot.id;

        card.innerHTML = `
            <div class="d-flex align-items-start">
                <div class="room-left me-2">
                    <div class="room-display" style="cursor: pointer;">
                        <span class="badge bg-secondary room-badge">${slot.room || '?'}</span>
                    </div>
                    <div class="room-edit" style="display: none;">
                        <input type="text" 
                               class="form-control form-control-sm room-input" 
                               value="${slot.room || ''}" 
                               placeholder="–ö–∞–±" 
                               maxlength="10"
                               style="width: 50px;">
                    </div>
                </div>
                <div class="flex-grow-1 lesson-info">
                    <strong class="subject-name">${slot.subject_name}</strong><br>
                    <small class="text-muted">${slot.teacher_name}</small>
                </div>
                <button type="button" class="btn btn-sm btn-danger delete-slot ms-2" data-slot-id="${slot.id}">
                    <i class="bi bi-trash"></i>
                </button>
            </div>
        `;

        attachCardEvents(card, slot.id);
        return card;
    }

    // ============ –°–û–ë–´–¢–ò–Ø –ö–ê–†–¢–û–ß–ö–ò ============
    function attachCardEvents(card, slotId) {
        const roomDisplay = card.querySelector('.room-display');
        const roomEdit = card.querySelector('.room-edit');
        const roomInput = card.querySelector('.room-input');
        const deleteBtn = card.querySelector('.delete-slot');

        // –ö–ª–∏–∫ –Ω–∞ –∫–∞–±–∏–Ω–µ—Ç - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        roomDisplay.addEventListener('click', function(e) {
            e.stopPropagation();
            roomDisplay.style.display = 'none';
            roomEdit.style.display = 'block';
            roomInput.focus();
            roomInput.select();
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ Enter
        roomInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                updateRoom(slotId, roomInput.value, card);
            } else if (e.key === 'Escape') {
                roomDisplay.style.display = 'block';
                roomEdit.style.display = 'none';
            }
        });

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞
        roomInput.addEventListener('blur', function() {
            setTimeout(() => {
                updateRoom(slotId, roomInput.value, card);
            }, 200);
        });

        // –£–¥–∞–ª–µ–Ω–∏–µ
        deleteBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            deleteScheduleSlot(slotId, card);
        });
    }

    // ============ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ö–ê–ë–ò–ù–ï–¢–ê ============
    function updateRoom(slotId, room, cardElement) {
        const roomDisplay = cardElement.querySelector('.room-display');
        const roomEdit = cardElement.querySelector('.room-edit');
        const roomBadge = cardElement.querySelector('.room-badge');

        fetch(`/schedule/constructor/update-room/${slotId}/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrftoken
            },
            body: JSON.stringify({ room: room || '' })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                roomBadge.textContent = data.room || '?';
                roomDisplay.style.display = 'block';
                roomEdit.style.display = 'none';
                if (room) {
                    showNotification('‚úÖ –ö–∞–±–∏–Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω: ' + data.room, 'success');
                }
            } else {
                showNotification('‚ùå ' + data.error, 'danger');
            }
        })
        .catch(error => {
            showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'danger');
        });
    }

    // ============ –£–î–ê–õ–ï–ù–ò–ï –ó–ê–ù–Ø–¢–ò–Ø ============
    function deleteScheduleSlot(slotId, cardElement) {
        if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –∑–∞–Ω—è—Ç–∏–µ?')) return;

        fetch(`/schedule/constructor/delete/${slotId}/`, {
            method: 'POST',
            headers: { 'X-CSRFToken': csrftoken }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                cardElement.remove();
                showNotification('üóëÔ∏è –ó–∞–Ω—è—Ç–∏–µ —É–¥–∞–ª–µ–Ω–æ', 'success');
            } else {
                showNotification('‚ùå ' + data.error, 'danger');
            }
        })
        .catch(error => {
            showNotification('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'danger');
        });
    }

    // ============ –°–û–ë–´–¢–ò–Ø –î–õ–Ø –°–£–©–ï–°–¢–í–£–Æ–©–ò–• –ö–ê–†–¢–û–ß–ï–ö ============
    document.querySelectorAll('.lesson-card').forEach(card => {
        const slotId = card.dataset.slotId;
        attachCardEvents(card, slotId);
    });

    // ============ –§–ò–õ–¨–¢–† –ì–†–£–ü–ü ============
    const groupFilter = document.getElementById('groupFilter');
    if (groupFilter) {
        groupFilter.addEventListener('change', function() {
            const groupId = this.value;
            window.location.href = groupId ? `/schedule/constructor/?group=${groupId}` : '/schedule/constructor/';
        });
    }

    // ============ –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ö–û–ù–§–õ–ò–ö–¢–û–í ============
    function showConflictModal(message, conflicts) {
        const modal = new bootstrap.Modal(document.getElementById('conflictModal'));
        const messageEl = document.getElementById('conflictMessage');
        
        let html = `<div class="alert alert-danger"><strong>${message}</strong></div>`;
        
        if (conflicts && conflicts.length > 0) {
            html += '<ul class="mb-0">';
            conflicts.forEach(c => {
                html += `<li>${c}</li>`;
            });
            html += '</ul>';
        }
        
        messageEl.innerHTML = html;
        modal.show();
        
        showNotification('‚ùå ' + message, 'danger');
    }

    // ============ –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ============
    function showNotification(message, type) {
        let container = document.getElementById('notification-container');
        if (!container) {
            container = document.createElement('div');
            container.id = 'notification-container';
            container.style.cssText = 'position:fixed;top:20px;right:20px;z-index:9999;max-width:350px;';
            document.body.appendChild(container);
        }

        const alert = document.createElement('div');
        alert.className = `alert alert-${type} alert-dismissible fade show shadow`;
        alert.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        container.appendChild(alert);

        setTimeout(() => {
            alert.classList.remove('show');
            setTimeout(() => alert.remove(), 150);
        }, 4000);
    }

    console.log('‚úÖ –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã');
});
</script>
{% endblock %}